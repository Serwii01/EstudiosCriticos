<div class="admin-view animate-fade-in">
  <div class="container-narrow">

    <section *ngIf="!authService.isAuthenticated()" class="ec-card auth-card">
      <div class="section-header">
        <div class="section-header__bar"></div>
        <h2 class="ec-heading-lg">Acceso Administrador</h2>
      </div>
      
      <p class="auth-card__intro ec-subtitle-serif">Identifícate para gestionar el portal.</p>

      <form class="ec-form" [formGroup]="loginForm" (ngSubmit)="onLogin()">
        <div class="ec-form__group">
          <label class="ec-label">Usuario</label>
          <input type="text" formControlName="user" class="ec-input" placeholder="Tu usuario">
        </div>

        <div class="ec-form__group">
          <label class="ec-label">Contraseña</label>
          <input type="password" formControlName="pass" class="ec-input" placeholder="••••••••">
        </div>

        <p *ngIf="loginError" class="ec-error">Acceso denegado</p>
        <button type="submit" class="ec-btn-primary full-width" [disabled]="loginForm.invalid">Entrar</button>
      </form>
    </section>

    <section *ngIf="authService.isAuthenticated()" class="admin-panel">
      <div class="section-header section-header--row">
        <div class="section-header__left">
          <div class="section-header__bar"></div>
          <h2 class="ec-heading-lg">Nueva Publicación</h2>
        </div>
        <button (click)="authService.logout()" class="btn-logout">
          <mat-icon>logout</mat-icon> Salir </button>
      </div>

      <div class="ec-card">
        <form class="ec-form" [formGroup]="newsForm">
          
          <div class="ec-form__group">
            <label class="ec-label">Titular</label>
            <input type="text" formControlName="title" class="ec-input ec-input--title" placeholder="Escribe el título aquí...">
            <span class="ec-error-inline" *ngIf="newsForm.get('title')?.invalid && newsForm.get('title')?.touched">
              El titular es obligatorio (mín. 5 letras).
            </span>
          </div>

          <div class="ec-form__row">
            <div class="ec-form__group">
              <label class="ec-label">Asamblea</label>
              <select formControlName="assembly" class="ec-input ec-select">
                <option *ngFor="let asm of assemblies" [value]="asm">{{ asm }}</option>
              </select>
            </div>
            <div class="ec-form__group">
              <label class="ec-label">Tipo de actividad</label>
              <select formControlName="activityType" class="ec-input ec-select">
                <option *ngFor="let type of activityTypes" [value]="type">{{ type }}</option>
              </select>
            </div>
          </div>

          <div class="ec-form__group">
            <label class="ec-label">Imagen de portada</label>
            <div class="file-upload-wrapper">
              <input type="file" (change)="onFileSelected($event)" accept="image/*" id="file-input" class="hidden-input">
              <label for="file-input" class="file-upload-label">
                <mat-icon class="principle-icon">cloud_upload</mat-icon> <span class="file-text">{{ selectedFile ? selectedFile.name : 'Subir imagen de portada' }}</span>
              </label>
            </div>
          </div>

          <div class="ec-form__group">
            <label class="ec-label">Resumen</label>
            <textarea formControlName="description" class="ec-input" rows="3"></textarea>
          </div>

          <div class="ec-form__group">
            <label class="ec-label">Cuerpo de la noticia</label>
            <textarea formControlName="longDescription" class="ec-input ec-input--serif" rows="8"></textarea>
          </div>

          <button type="button" (click)="onCreateNews()" class="ec-btn-primary ec-btn--submit" [disabled]="newsForm.invalid">
            <mat-icon>send</mat-icon> Publicar noticia </button>
        </form>
      </div>
    </section>
  </div>
</div>